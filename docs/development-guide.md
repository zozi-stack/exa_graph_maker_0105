# Development Guide

> Auto-generated by BMAD Document Project workflow  
> Scan Level: Exhaustive  
> Generated: 2026-01-04

## Prerequisites

| Requirement | Version | Check Command |
|-------------|---------|---------------|
| Node.js | ≥18.0.0 | `node --version` |
| npm | ≥9.0.0 | `npm --version` |

---

## Quick Start

```bash
# 1. Install dependencies
npm install

# 2. Start development server
npm run dev

# 3. Open in browser
# → http://localhost:5173
```

---

## Available Scripts

| Command | Description |
|---------|-------------|
| `npm run dev` | Start Vite dev server with HMR |
| `npm run build` | Type-check and build for production |
| `npm run preview` | Preview production build locally |
| `npm run lint` | Run ESLint on TypeScript files |

### Script Details

#### `npm run dev`
```bash
vite
```
Starts the Vite development server at `http://localhost:5173` with:
- Hot Module Replacement (HMR)
- Fast refresh for React components
- Source maps for debugging

#### `npm run build`
```bash
tsc && vite build
```
1. Runs TypeScript compiler to check for type errors
2. Bundles the application with Vite
3. Outputs to `dist/` directory

#### `npm run lint`
```bash
eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0
```
Strict linting with zero tolerance for warnings.

---

## Environment Setup

### Font Installation

The application uses custom fonts that must be present in `public/fonts/`:

**Required:**
- `ABC Arizona Flare/ABCArizonaFlare-Regular-Trial.woff2`
- `ABC Arizona Flare/ABCArizonaFlare-Bold-Trial.woff2`

**Optional (referenced in CSS but may not be present):**
- `ABC Diatype/ABCDiatype-Regular.woff2`
- `ABC Diatype/ABCDiatype-Medium.woff2`

### No Environment Variables Required

This is a client-side only application with no backend. No `.env` file is needed.

---

## Development Workflow

### Adding a New Component

1. Create component file in `src/components/`:
   ```typescript
   // src/components/MyComponent.tsx
   import styles from './MyComponent.module.css';
   
   interface MyComponentProps {
     // props
   }
   
   const MyComponent = ({ }: MyComponentProps) => {
     return <div className={styles.container}>...</div>;
   };
   
   export default MyComponent;
   ```

2. Create CSS Module:
   ```css
   /* src/components/MyComponent.module.css */
   .container {
     /* styles */
   }
   ```

3. Import in parent component:
   ```typescript
   import MyComponent from './components/MyComponent';
   ```

### Modifying Chart Rendering

The chart rendering logic is in `src/components/EvalChart.tsx`:

1. **Bar Chart Logic:** Lines 313-463
2. **Scatter Plot Logic:** Lines 140-311
3. **Export Function:** Lines 57-88

Key D3 patterns used:
- `d3.scaleBand()` for categorical X-axis
- `d3.scaleLinear()` for numerical Y-axis
- SVG `<rect>` for bars, `<circle>`/`<rect>` for scatter points

### Adding a New Chart Type

1. Add type to `ChartType` union in `src/types/eval.types.ts`
2. Add default data structure in `App.tsx`
3. Add rendering branch in `EvalChart.tsx` useEffect
4. Add controls in `ControlPanel.tsx`

---

## TypeScript Configuration

### `tsconfig.json` (Main)
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true
  }
}
```

### Key Type Definitions

```typescript
// src/types/eval.types.ts

interface Company {
  name: string;
  accuracy: number;
  color: string;
  icon: string;
  highlighted?: boolean;
}

interface ScatterPoint {
  x: number;
  y: number;
  label?: string;
  sublabel?: string;
  color: string;
  size?: number;
  highlighted?: boolean;
  icon?: string;
}

type ChartType = 'bar' | 'scatter';

interface EvalData {
  id: string;
  title: string;
  yAxisLabel: string;
  xAxisLabel?: string;
  chartType: ChartType;
  companies: Company[];
  scatterPoints?: ScatterPoint[];
  // ... axis range options
}
```

---

## Debugging Tips

### React DevTools
Install the React DevTools browser extension to inspect:
- Component hierarchy
- Props and state
- Re-render causes

### D3 Debugging
The chart uses two SVG layers:
- `gridSvgRef` - Background grid (z-index: 1)
- `barsSvgRef` - Bars/points (z-index: 10)

Inspect these in browser DevTools to debug rendering issues.

### Export Issues
If PNG export fails:
1. Check console for errors
2. Ensure fonts are loaded (`document.fonts.ready`)
3. Verify `dom-to-image-more` compatibility with SVG content

---

## Code Style

### ESLint Rules
- React Hooks rules enabled
- React Refresh rules enabled
- TypeScript strict mode
- No unused variables/parameters

### Naming Conventions
| Type | Convention | Example |
|------|------------|---------|
| Components | PascalCase | `EvalChart` |
| Hooks | camelCase, use* prefix | `useState` |
| CSS classes | camelCase | `.chartContainer` |
| Constants | UPPER_SNAKE_CASE | `DEFAULT_MARGIN` |
| Types/Interfaces | PascalCase | `EvalData` |

---

## Common Tasks

### Change Default Chart Data
Edit `src/data/evals.json`:
```json
{
  "id": "initial-graph",
  "title": "Your Title",
  "yAxisLabel": "Metric (%)",
  "chartType": "bar",
  "companies": [...]
}
```

### Add a New Company Icon
1. Add PNG to `public/images/`
2. Update `iconMap` in `EvalChart.tsx`:
   ```typescript
   const iconMap: Record<string, string> = {
     'Exa': '/images/exablue.png',
     'NewCompany': '/images/new-logo.png',
   };
   ```

### Adjust Chart Dimensions
In `EvalChart.tsx`:
```typescript
const margin = { top: 15, right: 30, bottom: 50, left: 70 };
const width = 640;  // Total chart width
const height = 300; // Total chart height
```

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| Fonts not loading | Check paths in `index.css`, ensure files exist in `public/fonts/` |
| Charts not rendering | Check browser console for D3 errors, verify data structure |
| Export blank image | Ensure `dom-to-image-more` can access all elements, check CORS for images |
| TypeScript errors | Run `npm run build` to see full error list |
| HMR not working | Restart dev server, clear browser cache |

